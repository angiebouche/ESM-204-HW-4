---
title: "ESM 204 HW 4"
author: "Angie Bouche"
date: "June 5, 2019"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(stargazer)
library(dplyr)
library(ggplot2)
library(Hmisc)

emissions <- read_csv("HW4Data.csv")
```

##Part 1 Regressions
```{r}

model_a1 <- lm(MC_A ~ Abatement, data = emissions, family="linear")
summary(model_a1) #r square .91

#y = 0.57684 x - 8.64448

model_b1 <- lm(MC_B ~ Abatement, data = emissions, family="linear")
summary(model_b1) #r sq .56

#y = 0.19874 x + 9.31770

model_c1 <- lm(MC_C ~ Abatement, data = emissions, family="linear")
summary(model_c1) #r sq .87

#y = 0.78383 x - 11.65503

model_d1 <- lm(MC_D ~ Abatement, data = emissions, family="linear")
summary(model_d1)#r sq .54

#y = 0.25993 x + 9.68751

stargazer(model_a1, model_b1, model_c1, model_d1, type="text", title="Regression Results")

```
###Plot
```{r}

ggplot(emissions, aes(x = Abatement, y = MC_A)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red")+
  ylab("Marginal Cost of Abatement (Sector A)")+
  theme_classic()

ggplot(emissions, aes(x = Abatement, y = MC_B)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "blue")+
  ylab("Marginal Cost of Abatement (Sector B)")+
  theme_classic()

ggplot(emissions, aes(x = Abatement, y = MC_C)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "green")+
  ylab("Marginal Cost of Abatement (Sector C)")+
  theme_classic()

ggplot(emissions, aes(x = Abatement, y = MC_D)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "black")+
  ylab("Marginal Cost of Abatement (Sector D)")+
  theme_classic()


```


##Part 2 Demand
```{r}

#find yint
#y = 0.57684 x - 8.64448
-8.64448 + (0.57684*180)
#(0, 95.18672)

#y = 0.19874 x + 9.31770
9.31770 + (0.19874*200)
#(0, 49.0657)

#y = 0.78383 x - 11.65503
-11.65503 + (0.78383*220)
#(0, 160.7876)

#y = 0.25993 x + 9.68751
9.68751 + (0.25993*300)
#(0, 87.66651)

#Sector C is willing to pay the most for the first unit, because they have the largest y intercept??


#find xint
#y = 0.57684 x - 8.64448
(95.18672 - 0)/0.57684
#(165.0141, 0)

#y = 0.19874 x + 9.31770
(49.0657-0)/ 0.19874
#(246.8839, 0)

#y = 0.78383 x - 11.65503
(160.7876-0)/0.78383
#(205.1307, 0)

#y = 0.25993 x + 9.68751
(87.66651 -0)/0.25993
#(337.2697,0)


#no idea what this does but it was in the other code - making a dataset of points along the demand curve?
demanda<-Hmisc::bezier(x = c(0, 165.0141), y = c(95.18672, 0)) %>% as_data_frame()
#y = -0.57684 x + 95.18672
demandb<- Hmisc::bezier(x = c(0, 246.8839), y = c(49.0657, 0)) %>% as_data_frame()
#y = -0.19874 x + 49.0657
demandc<-Hmisc::bezier(x = c(0, 205.1307), y = c(160.7876, 0)) %>% as_data_frame()
#y = -0.78383 x + 160.7876
demandd<- Hmisc::bezier(x = c(0, 337.2697), y = c(87.66651, 0)) %>% as_data_frame()
#y = -0.25993 x + 87.66651

demanda$type<- rep("Sector A", length(demanda$x))
demandb$type<- rep("Sector B", length(demandb$x))
demandc$type<-rep("Sector C", length(demandc$x))
demandd$type<- rep("Sector D", length(demandc$x))

#merging all the demand curves together
all<- rbind(demanda, demandb, demandc, demandd)
all

ggplot(all, aes(x=x, y=y, color=type))+
  #tiff('demand.tiff', units="in", width=10, height=5, res=300)+
  geom_line(size=1)+
  labs(x="Carbon Emissions (tons)", y="Price ($) per Ton", title="Estimated Demand Curve for Carbon Emissions")+
  theme_classic()+
  scale_x_continuous(expand=c(0,0))+
  scale_y_continuous(expand=c(0,0))+
  theme(legend.title=element_blank())+
  theme(plot.title = element_text(hjust = 0.5))

```


#$Part 3: Couty X
### Carbon Cap
####No tax revenue generated
```{r}
#MC when 100 tons are abated
MCa100 = (-0.57684*100) + 95.18672 
#37
MCb100= (-0.19874*100) + 49.0657
#29
MCc100= (-0.78383*100) + 160.7876
#82

#Find area under demand curve for x=0-100. Add area of rectange and triangle together
TCa100 = (100*MCa100)+((95.18672- MCa100)*100*.5)
TCb100 = (100*MCb100)+((49.0657- MCb100)*100*.5)
TCc100 = (100*MCc100)+((160.7876- MCc100)*100*.5)

Tc100 = TCa100 +TCb100+ TCc100

```

### Carbon Tax
```{r}
#Aggreate  MC for tax
Aggregate_Tax = (617.0287 - 300) /8


```

##Part 5 
### A- With a cap and trade market, country X will reduce its emissions by 300 tons overall, leaving 300 tons of carbon emitted. This corresponds with 300 tons of local air pollution. For country Y, if they aren't in a cap and trade program they will continue to emit 300 tons of carbon, which corresponds with 300 tons of air pollution there. 